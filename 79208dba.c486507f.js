(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{108:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return u})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return p})),n.d(t,"default",(function(){return m}));var r=n(3),a=n(7),i=(n(0),n(154)),l=n(160),o=n(156),c=n(157),u={id:"custom-player-objects",title:"Wrapping Custom Player Objects",sidebar_label:"Using custom Player objects",slug:"/custom-player-objects"},s={unversionedId:"guides/custom-player-objects",id:"guides/custom-player-objects",isDocsHomePage:!1,title:"Wrapping Custom Player Objects",description:"How one might do it",source:"@site/docs/guides/connect-wrapper.md",slug:"/custom-player-objects",permalink:"/docs/3.0/custom-player-objects",editUrl:"https://github.com/roblox-aurora/rbx-net/edit/main/docs/docs/guides/connect-wrapper.md",version:"current",sidebar_label:"Using custom Player objects",sidebar:"docs",previous:{title:"Using Compile Time Remote IDs",permalink:"/docs/3.0/uuid"},next:{title:"Rate limiting your remotes",permalink:"/docs/3.0/middleware/rate-limit"}},p=[{value:"How one might do it",id:"how-one-might-do-it",children:[]},{value:"Using a wrapper",id:"using-a-wrapper",children:[]}],y={toc:p};function m(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},y,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"how-one-might-do-it"},"How one might do it"),Object(i.b)("p",null,"A common pattern when using remotes - on the server - is to require casting a player to an object representation of the player."),Object(i.b)("p",null,"This may come as the following sort of situation:"),Object(i.b)(o.a,{defaultValue:l.a,groupId:l.b,values:l.c,mdxType:"Tabs"},Object(i.b)(c.a,{value:"ts",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import Remotes from "shared/remotes";\nimport PlayerService from "server/Services/PlayerService";\n\nconst PlayerEquipItem = Remotes.Server.Get("PlayerEquipItem");\nPlayerEquipItem.Connect((player, itemId) => {\n    const entity = PlayerService.GetEntity(player);\n    if (entity) {\n        entity.EquipItem(itemId);\n    }\n})\n\nconst PlayerUnequipItem = Remotes.Server.Get("PlayerUnequipItem")\nPlayerUnequipItem.Connect((player, itemId) => {\n    const entity = PlayerService.GetEntity(player);\n    if (entity) {\n        entity.UnequipItem(itemId);\n    }\n})\n\nconst GetPlayerEquipped = Remotes.Server.Get("GetPlayerEquipped")\nGetPlayerEquipped.SetCallback((player) => {\n    const entity = PlayerService.GetEntity(player);\n    if (entity) {\n        return entity.GetEquippedItems();\n    }\n})\n'))),Object(i.b)(c.a,{value:"luau",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-lua"}),'local PlayerService = require(ServerScriptService.Services.PlayerService)\nlocal Remotes = require(ReplicatedStorage.Remotes)\n\nlocal PlayerEquipItem = Remotes.Server:Get("PlayerEquipItem")\nPlayerEquipItem:Connect(function (player, itemId)\n    local entity = PlayerService:GetEntity(player)\n    if entity then\n        entity:EquipItem(itemId)\n    end\nend)\n\nlocal PlayerUnequipItem = Remotes.Server:Get("PlayerUnequipItem")\nPlayerUnequipItem:Connect(function (player, itemId)\n    local entity = PlayerService:GetEntity(player)\n    if entity then\n        entity:UnequipItem(itemId)\n    end\nend)\n\nlocal GetPlayerEquipped = Remotes.Server:Get("GetPlayerEquipped")\nGetPlayerEquipped:SetCallback(function(player)\n    local entity = PlayerService:GetEntity(player)\n    if entity then\n        return entity:GetEquippedItems()\n    end\nend)\n')))),Object(i.b)("p",null,"As you might have noticed, there's some repeated code where we're repetitively having to grab the player entity here in place of the player."),Object(i.b)("p",null,"We can instead use what's called a ",Object(i.b)("em",{parentName:"p"},"wrapper")," to do this for us and make it as if we were connecting directly to the remote and it had the entity as the player argument rather than a player."),Object(i.b)("h2",{id:"using-a-wrapper"},"Using a wrapper"),Object(i.b)("p",null,"We can define a ",Object(i.b)("inlineCode",{parentName:"p"},"withPlayerEntity")," wrapper, which will achieve what we're doing above in each remote separately. This is the recommended method when augmenting the player argument as it's the safest method and guaranteed to run after all the middleware."),Object(i.b)(o.a,{defaultValue:l.a,groupId:l.b,values:l.c,mdxType:"Tabs"},Object(i.b)(c.a,{value:"ts",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts",metastring:'title="server/Wrappers/withPlayerEntity.ts"',title:'"server/Wrappers/withPlayerEntity.ts"'}),'import PlayerService from "server/Services/PlayerService";\nimport PlayerEntity from "server/Classes/PlayerEntity";\n\nexport default function withPlayerEntity<T extends Array<unknown>, R = void>(\n    fn: (playerEntity: PlayerEntity, ...args: T) => R,\n) {\n    return (player: Player, ...args: T) => {\n        const entity = PlayerService.GetEntity(player);\n        if (entity) {\n            return fn(entity, ...args);\n        }\n    };\n}\n'))),Object(i.b)(c.a,{value:"luau",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-lua",metastring:'title="src/server/Wrappers/withPlayerEntity.lua"',title:'"src/server/Wrappers/withPlayerEntity.lua"'}),"local PlayerService = require(ServerScriptService.Services.PlayerService)\n\nlocal function withPlayerEntity(fn)\n    return function (player, ...)\n        local entity = playerService:GetEntity(player)\n        if entity then\n            return fn(entity, ...)\n        end\n    end\nend\n\nreturn withPlayerEntity\n")))),Object(i.b)("p",null,"Then we can apply this to the code above."),Object(i.b)(o.a,{defaultValue:l.a,groupId:l.b,values:l.c,mdxType:"Tabs"},Object(i.b)(c.a,{value:"ts",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'import PlayerService from "server/Services/PlayerService";\nimport Remotes from "shared/remotes";\nimport withPlayerEntity from "server/Wrappers/withPlayerEntity";\n\nconst PlayerEquipItem = Remotes.Server.Get("PlayerEquipItem")\nPlayerEquipItem.Connect(\n    withPlayerEntity((entity, itemId) => {\n        entity.EquipItem(itemId);\n    })\n);\n\nconst PlayerUnequipItem = Remotes.Server.Get("PlayerUnequipItem")\nPlayerUnequipItem.Connect((player, itemId) => {\n    withPlayerEntity((entity, itemId) => {\n        entity.UnequipItem(itemId);\n    })\n})\n\nconst GetPlayerEquipped = Remotes.Server.Get("GetPlayerEquipped")\nGetPlayerEquipped.SetCallback(\n    withPlayerEntity((player) => {\n        return entity.GetEquippedItems();\n    })\n)\n'))),Object(i.b)(c.a,{value:"luau",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-lua"}),'local PlayerService = require(ServerScriptService.Services.PlayerService)\nlocal Remotes = require(ReplicatedStorage.Remotes)\nlocal withPlayerEntity = require(ServerScriptService.Wrappers.withPlayerEntity)\n\nlocal PlayerEquipItem = Remotes.Server:Get("PlayerEquipItem")\nPlayerEquipItem:Connect(\n    withPlayerEntity(function (entity, itemId)\n        entity:EquipItem(itemId)\n    end)\n)\n\nlocal PlayerUnequipItem = Remotes.Server:Get("PlayerUnequipItem")\nPlayerUnequipItem:Connect(\n    withPlayerEntity(function (player, itemId)\n        entity:UnequipItem(itemId)\n    end)\n)\n\nlocal GetPlayerEquipped = Remotes.Server:Get("GetPlayerEquipped")\nGetPlayerEquipped:SetCallback(\n    withPlayerEntity(function(player)\n        return entity:GetEquippedItems()\n    end)\n)\n')))),Object(i.b)("p",null,"And as you can see, this reduces repetitive code and gives us the ",Object(i.b)("inlineCode",{parentName:"p"},"PlayerEntity")," object to work with. Simple as that."))}m.isMDXComponent=!0},154:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var r=n(0),a=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=a.a.createContext({}),s=function(e){var t=a.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=s(e.components);return a.a.createElement(u.Provider,{value:t},e.children)},y={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),p=s(n),m=r,d=p["".concat(l,".").concat(m)]||p[m]||y[m]||i;return n?a.a.createElement(d,o(o({ref:t},u),{},{components:n})):a.a.createElement(d,o({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=n[u];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},155:function(e,t,n){"use strict";function r(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}t.a=function(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}},156:function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(158),l=n(155),o=n(56),c=n.n(o),u=37,s=39;t.a=function(e){var t=e.lazy,n=e.block,o=e.defaultValue,p=e.values,y=e.groupId,m=e.className,d=Object(i.a)(),b=d.tabGroupChoices,f=d.setTabGroupChoices,v=Object(r.useState)(o),h=v[0],P=v[1],g=r.Children.toArray(e.children);if(null!=y){var E=b[y];null!=E&&E!==h&&p.some((function(e){return e.value===E}))&&P(E)}var O=function(e){P(e),null!=y&&f(y,e)},j=[];return a.a.createElement("div",null,a.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(l.a)("tabs",{"tabs--block":n},m)},p.map((function(e){var t=e.value,n=e.label;return a.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":h===t,className:Object(l.a)("tabs__item",c.a.tabItem,{"tabs__item--active":h===t}),key:t,ref:function(e){return j.push(e)},onKeyDown:function(e){!function(e,t,n){switch(n.keyCode){case s:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case u:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(j,e.target,e)},onFocus:function(){return O(t)},onClick:function(){O(t)}},n)}))),t?Object(r.cloneElement)(g.filter((function(e){return e.props.value===h}))[0],{className:"margin-vert--md"}):a.a.createElement("div",{className:"margin-vert--md"},g.map((function(e,t){return Object(r.cloneElement)(e,{key:t,hidden:e.props.value!==h})}))))}},157:function(e,t,n){"use strict";var r=n(3),a=n(0),i=n.n(a);t.a=function(e){var t=e.children,n=e.hidden,a=e.className;return i.a.createElement("div",Object(r.a)({role:"tabpanel"},{hidden:n,className:a}),t)}},158:function(e,t,n){"use strict";var r=n(0),a=n(159);t.a=function(){var e=Object(r.useContext)(a.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},159:function(e,t,n){"use strict";var r=n(0),a=Object(r.createContext)(void 0);t.a=a},160:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(0),a=n.n(r),i=n(156),l=n(157),o="ts",c="code",u=[{label:"roblox-ts",value:"ts"},{label:"luau",value:"luau"}];t.d=function(e){var t=e.children,n=t[0],r=t[1];return console.log(n,r),a.a.createElement(i.a,{defaultValue:o,groupId:c,values:u},a.a.createElement(l.a,{value:"ts"},n),a.a.createElement(l.a,{value:"luau"},r))}}}]);