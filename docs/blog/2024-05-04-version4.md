---
slug: 4.0-release
title: v4.0
author: Vorlias
author_url: https://github.com/vorlias
author_image_url: https://avatars0.githubusercontent.com/u/10781792?s=400&v=4
tags: [update]
---

Welcome to the release of v4.0 of Net. This is a major update from v3.0 and has some design changes from the previous version of Net.

## What's changed
- Net now uses a "builder" model for describing a Network Object Model (NOM) - whereas before you'd do:
```ts title="Net v3.0 Declarations"
import Net from "@rbxts/net";
import t from "@rbxts/t";
export = Net.Create({
    TestServerAsyncFunction: Net.Definitions.ServerAsyncFunction<[name: string], boolean>(),
    TestEventWithTypeChecking: Net.Definitions.ClientToServerEvent<[text: string]>([
        Net.Middleware.TypeChecking(t.string)
    ]),
    TestRateLimitWithTypeChecking: Net.Definitions.ClientToServerEvent([
        Net.Middleware.TypeChecking(t.string),
        Net.Middleware.RateLimit({ RequestsPerWindow: 5, RequestWindow: NetDuration.minutes(1) }),
        // no return checks!! D:
    ]),
});
```

```ts title="Net v4.0 Network Object Model"
import Net from "@rbxts/net";
import t from "@rbxts/t";
export = Net.Create()
    .AddServerOwned("TestServerAsyncFunction", Net.Remote<[name: string]>().WhichReturnsAsync<boolean>())
    .AddClientOwned("TestEventWithTypeChecking", Net.Remote<[text: string]>(t.string))
    // Much simpler! :D
    .AddClientOwned(
        "TestRateLimitWithTypeChecking", 
        Net.Remote(t.string)
           .WithRateLimit({ RequestsPerWindow: 5, RequestWindow: NetDuration.minutes(1) })
           .WhichReturnsAsync(t.boolean)
    )
    .Build();
```

## New Additions
- Added `Net.BuildDefinition()` - This will return a Network Object Model factory, which then has the following methods under it:
    - `AddServerOwned(id: string, nob: NetworkObject)` - Will add the specified remote as owned by the server (the server invokes events, or handles callbacks for functions)
    - `AddClientOwned(id: string, nob: NetworkObject)` - Will add the specified remote as owned by the client (the client invokes events, or handles callbacks for functions)
    - `AddNamespace(id: string, nom: NetworkObjectModel)` - Adds a sub-model (scoped) to the parent model
    - `SetConfiguration(configuration: Configuration)` - Will set a configuration on this Network Object Model
    - `Build()` - Will construct the Network Object Model to actual network objects you can use with the Net API
- Added `Net.Remote()` - This will return a builder for a remote object, and by itself will be a unit network event - and has the following "augmentations":
    - `WhichReturnsAsync<T>(check?: Check<T>)` - Specifies this remote is an `AsyncFunction` which returns `T` - You can also add a runtime type check as the argument
    - `AsUnreliable()` - Specifies that the remote is an unreliable event (events by default are _reliable_)
    - `WithArgumentTypes(...typeChecks: Check[])` - using a type checker such as [t](https://github.com/osyrisrblx/t), you can have explicit type checking. You can also pass these directly to `Net.Remote(...typeChecks: Check[])` to give runtime type checking
- Added `Net.Broadcaster<T>(check: Check<T>)` - Similar to a `Net.Remote` - but server-only and used for server-to-server messaging
- Added a _Mock Context_, this means that Net should work in test environments

## Changes since v3.x
With the above changes, the old legacy API is still currently accessible under `BuildDefinition(definitions: RemoteDefinitions)` - and old definitions can be added via `AddLegacyDefinitions`.

## Removals